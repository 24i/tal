<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    
        <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-38709464-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

    <!-- Web fonts -->
    <link href='http://fonts.googleapis.com/css?family=Sintony' rel='stylesheet' type='text/css'>

    <!-- Le styles -->
    <link href="/tal/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
    </style>
    <link href="/tal/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="/tal/css/pygments.css" rel="stylesheet">
    <link href="/tal/css/main.css" rel="stylesheet">
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="/tal/js/html5shiv.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="/tal/img/favicon.png">
    
  </head>

  <body>

        <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
        <a class="brand" href="/tal/index.html"><img src="/tal/img/bbclogo.png"></a>
        <ul class="nav">

          <!-- Landing Page -->          
          <li class="active"><a href="/tal/index.html">Home</a></li>
          
          <!-- Getting started pages -->
          <li class="dropdown active">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started<b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="/tal/getting-started/introducing-tal.html">Introducing TAL</a></li>
              <li><a href="/tal/getting-started/tutorial/installation.html">Installation</a></li>
              <li><a href="/tal/getting-started/tutorial/createanindex.html">The Index</a></li>
              <li><a href="/tal/getting-started/tutorial/applicationclass.html">Launch the App</a></li>
              <li><a href="/tal/getting-started/tutorial/firstcomponent.html">First Component</a></li>
              <li><a href="/tal/getting-started/tutorial/layout.html">Example Layout &amp; Style</a></li>
            </ul>
          </li>

          <!-- Technical overview sections -->
          <li class="dropdown active">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview<b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="/tal/overview/concepts.html">Concepts</a></li>
              <li class="divider"></li>
              <li><a href="/tal/overview/device-configuration.html">Device Config</a></li>
              <li><a href="/tal/overview/components.html">Components</a></li>
              <li><a href="/tal/overview/layouts.html">Layouts and Style</a></li>
              <li><a href="/tal/overview/events.html">Events</a></li>
            </ul>
          </li>
          
          <!-- Widget documentation -->
          <li class="dropdown active">
            <a href="/tal/widgets" class="dropdown-toggle" data-toggle="dropdown">Widgets<b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="/tal/widgets/working-with-widgets.html">Working With Widgets</a></li>
              <li><a href="/tal/widgets/data-binding.html">Data Binding</a></li>
              <li><a href="/tal/widgets/media-playback.html">Media Playback</a></li>
              <li><a href="/tal/other/broadcast.html">Broadcast TV</a></li>
              <li><a href="/tal/widgets/focus-management.html">Focus Management</a></li>
              <li><a href="/tal/widgets/animation.html">Animation</a></li>
            </ul>
          </li>
          
          <!-- Miscelaneous topics -->
          <li class="dropdown active">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Other<b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="/tal/other/storage.html">Storage</a></li>
              <li><a href="/tal/other/exiting.html">Exiting</a></li>
              <li><a href="/tal/other/networking.html">Networking</a></li>
              <li><a href="/tal/other/contributing.html">Contributing</a></li>
              <li><a href="/tal/other/contact.html">Contact</a></li>
            </ul>
          </li>
          
          <!-- Class documentation -->
          <li class="active"><a href="/tal/jsdoc/index.html">JS Doc</a></li>
          
          <!-- Getting started pages -->
          <li class="active"><a href="/tal/testing.html">Testing</a></li>
          
          <!-- FAQ Section -->
          <li class="active"><a href="/tal/faq.html">FAQ</a></li>
        
        </ul>
        </div>
      </div>
    </div>
    
    


    <a href="https://github.com/fmtvp/tal"><img style="position: absolute; top: 0; right: 0; border: 0; z-index: 9999" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" alt="Fork me on GitHub"></a>
    
    <div class="container">
            
      <div class="row-fluid">
      
                <div class="span2">

          <img src="/tal/img/tal-logo-bw.jpg"></img>

          <p></p>
          <br />

          <p><code>ANTIE v1.0</code></p>
          <a class="btn btn-block btn-danger" type="button" href="https://github.com/fmtvp/tal/zipball/master"><i class="icon-download-alt icon-white"></i> Download ZIP</a>
          <a class="btn btn-block btn-danger" type="button" href="https://github.com/fmtvp/tal/tarball/master"><i class="icon-download-alt icon-white"></i> Download TAR</a>
          <a class="btn btn-block btn-danger" type="button" href="https://github.com/fmtvp/tal"><i class="icon-eye-open icon-white"></i> View on GitHub</a>

          <div>
            <p></p>
            <p>
              <a href="https://twitter.com/TALOpenSource" class="twitter-follow-button" data-show-count="false">Follow us</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
            </p>
            <p>
              <a href="https://twitter.com/share" class="twitter-share-button" data-via="TALOpenSource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
            </p>
          </div>

        </div>


        <div class="span9" style="margin-left: 40px">
      
          <h1 id='media_playback'>Media Playback</h1>

<p>The framework abstracts device specific media players to a common API based on the html5 MediaElement.</p>

<h2 id='creating_a_video_player'>Creating a video player</h2>

<p>This can be done in a device-agnostic way through the application&#8217;s device object.</p>

<p>If you are extending from <code>Application</code>, the device object is available via <code>getDevice()</code></p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>device</span> <span class='o'>=</span> <span class='k'>this</span><span class='p'>.</span><span class='nx'>getDevice</span><span class='p'>();</span>
</code></pre></div>
<p>If you are extending <code>Widget</code> or its subclasses:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>device</span> <span class='o'>=</span> <span class='k'>this</span><span class='p'>.</span><span class='nx'>getCurrentApplication</span><span class='p'>().</span><span class='nx'>getDevice</span><span class='p'>();</span>
</code></pre></div>
<p>You can then instantiate a video player:</p>
<div class='highlight'><pre><code class='javascript'><span class='k'>this</span><span class='p'>.</span><span class='nx'>_videoPlayer</span> <span class='o'>=</span> <span class='nx'>device</span><span class='p'>.</span><span class='nx'>createPlayer</span><span class='p'>(</span><span class='s2'>&quot;testPlayer&quot;</span><span class='p'>,</span> <span class='s2'>&quot;video&quot;</span><span class='p'>);</span>
</code></pre></div>
<p>The <code>_videoPlayer</code> object this gives you is of type <code>Media</code></p>

<h2 id='setting_the_video_source'>Setting the video source</h2>

<p>You can set video sources via the setSources() method: It takes an array of one or more MediaSource objects.</p>

<p>MediaSource objects are constructed with a url and mime type</p>
<div class='highlight'><pre><code class='javascript'><span class='k'>this</span><span class='p'>.</span><span class='nx'>_videoPlayer</span><span class='p'>.</span><span class='nx'>setSources</span><span class='p'>([</span>
    <span class='k'>new</span> <span class='nx'>MediaSource</span><span class='p'>(</span><span class='s2'>&quot;http://my.madeupvideo.com/somevid.mp4&quot;</span><span class='p'>,</span> <span class='s2'>&quot;video/mp4&quot;</span><span class='p'>)</span>
<span class='p'>]);</span>
</code></pre></div>
<h2 id='loading_video'>Loading video</h2>

<p>Once you have set the source, the load method will ask the device to request data.</p>
<div class='highlight'><pre><code class='javascript'><span class='k'>this</span><span class='p'>.</span><span class='nx'>_videoPlayer</span><span class='p'>.</span><span class='nx'>load</span><span class='p'>();</span>
</code></pre></div>
<h2 id='playing_video'>Playing video</h2>

<p>The play() method will attempt to play the video.</p>
<div class='highlight'><pre><code class='javascript'><span class='k'>this</span><span class='p'>.</span><span class='nx'>_videoPlayer</span><span class='p'>.</span><span class='nx'>play</span><span class='p'>();</span>
</code></pre></div>
<p>One way to use these methods is to attempt preload and wait for the video to be ready before calling <code>play()</code>. The &#8216;canplay&#8217; event is fired on <code>_videoPlayer</code> when it is able to play video.</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>self</span> <span class='o'>=</span> <span class='k'>this</span><span class='p'>;</span>

<span class='k'>this</span><span class='p'>.</span><span class='nx'>_videoPlayer</span><span class='p'>.</span><span class='nx'>addEventListener</span><span class='p'>(</span><span class='s2'>&quot;canplay&quot;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span>
    <span class='nx'>self</span><span class='p'>.</span><span class='nx'>_videoPlayer</span><span class='p'>.</span><span class='nx'>play</span><span class='p'>();</span>
<span class='p'>});</span>
</code></pre></div>
<h3 id='hiding_the_background'>Hiding the background</h3>

<p>Some devices always composite html on top of video playback, so if you use any sort of non-transparent background, playback will not be visible.</p>

<p>If this is the case, you will need to remove the background just before playback, then restore on stop.</p>

<p>One way to do this is via a <code>background-none</code> css class:</p>
<div class='highlight'><pre><code class='css'><span class='nc'>.background-none</span> <span class='p'>{</span>
    <span class='k'>background-image</span><span class='o'>:</span> <span class='k'>none</span> <span class='cp'>!important</span><span class='p'>;</span>
    <span class='k'>background-color</span><span class='o'>:</span> <span class='k'>transparent</span> <span class='cp'>!important</span><span class='p'>;</span>
<span class='p'>}</span>
</code></pre></div>
<p>You can check to see if a device requires this and apply the style using</p>
<div class='highlight'><pre><code class='javascript'><span class='k'>if</span> <span class='p'>(</span><span class='nx'>device</span><span class='p'>.</span><span class='nx'>getPlayerEmbedMode</span><span class='p'>()</span> <span class='o'>===</span> <span class='nx'>Media</span><span class='p'>.</span><span class='nx'>EMBED_MODE_BACKGROUND</span><span class='p'>)</span> <span class='p'>{</span>
    <span class='nx'>device</span><span class='p'>.</span><span class='nx'>addClassToElement</span><span class='p'>(</span><span class='nb'>document</span><span class='p'>.</span><span class='nx'>body</span><span class='p'>,</span> <span class='s1'>&#39;background-none&#39;</span><span class='p'>);</span>
    <span class='nx'>application</span><span class='p'>.</span><span class='nx'>getRootWidget</span><span class='p'>().</span><span class='nx'>addClass</span><span class='p'>(</span><span class='s1'>&#39;background-none&#39;</span><span class='p'>);</span>
<span class='p'>}</span>
<span class='nx'>player</span><span class='p'>.</span><span class='nx'>play</span><span class='p'>();</span>
</code></pre></div>
<p>Similarly, to show the background again</p>
<div class='highlight'><pre><code class='javascript'><span class='k'>if</span> <span class='p'>(</span><span class='k'>this</span><span class='p'>.</span><span class='nx'>_device</span><span class='p'>.</span><span class='nx'>getPlayerEmbedMode</span><span class='p'>()</span> <span class='o'>===</span> <span class='nx'>Media</span><span class='p'>.</span><span class='nx'>EMBED_MODE_BACKGROUND</span><span class='p'>)</span> <span class='p'>{</span>
    <span class='k'>this</span><span class='p'>.</span><span class='nx'>_device</span><span class='p'>.</span><span class='nx'>removeClassFromElement</span><span class='p'>(</span><span class='nb'>document</span><span class='p'>.</span><span class='nx'>body</span><span class='p'>,</span> <span class='s1'>&#39;background-none&#39;</span><span class='p'>);</span>
    <span class='k'>this</span><span class='p'>.</span><span class='nx'>_application</span><span class='p'>.</span><span class='nx'>getRootWidget</span><span class='p'>().</span><span class='nx'>removeClass</span><span class='p'>(</span><span class='s1'>&#39;background-none&#39;</span><span class='p'>);</span>
<span class='p'>}</span>
</code></pre></div>
<h2 id='stopping_a_video'>Stopping a video</h2>

<p>To interrupt playback you can call:</p>
<div class='highlight'><pre><code class='javascript'><span class='k'>this</span><span class='p'>.</span><span class='nx'>_videoPlayer</span><span class='p'>.</span><span class='nx'>pause</span><span class='p'>();</span>
</code></pre></div>
<p>If you want to close down the video player completely, for example if you are navigating to a different component, you should call</p>
<div class='highlight'><pre><code class='javascript'><span class='k'>this</span><span class='p'>.</span><span class='nx'>_videoPlayer</span><span class='p'>.</span><span class='nx'>destroy</span><span class='p'>();</span>
</code></pre></div>
<h2 id='media_events'>Media events</h2>

<p>These are all the lifecycle events fired by a media player that client applications can listen for.</p>
<table><thead><tr><th>Event</th><th>Description</th></tr></thead><tbody><tr><td style='text-align: left;'><code>loadstart</code></td><td style='text-align: left;'>The user agent begins looking for media data, as part of the resource selection algorithm. networkState equals NETWORK_LOADING</td>
</tr><tr><td style='text-align: left;'><code>progress</code></td><td style='text-align: left;'>The user agent is fetching media data. networkState equals NETWORK_LOADING</td>
</tr><tr><td style='text-align: left;'><code>suspend</code></td><td style='text-align: left;'>The user agent is intentionally not currently fetching media data, but does not have the entire media resource downloaded. networkState equals NETWORK_IDLE</td>
</tr><tr><td style='text-align: left;'><code>abort</code></td><td style='text-align: left;'>The user agent stops fetching the media data before it is completely downloaded, but not due to an error. error is an object with the code MEDIA_ERR_ABORTED. networkState equals either NETWORK_EMPTY or NETWORK_IDLE, depending on when the download was aborted.</td>
</tr><tr><td style='text-align: left;'><code>error</code></td><td style='text-align: left;'>An error occurs while fetching the media data. error is an object with the code MEDIA_ERR_NETWORK or higher. networkState equals either NETWORK_EMPTY or NETWORK_IDLE, depending on when the download was aborted.</td>
</tr><tr><td style='text-align: left;'><code>emptied</code></td><td style='text-align: left;'>A media element whose networkState was previously not in the NETWORK_EMPTY state has just switched to that state (either because of a fatal error during load that&#8217;s about to be reported, or because the load() method was invoked while the resource selection algorithm was already running). networkState is NETWORK_EMPTY; all the IDL attributes are in their initial states.</td>
</tr><tr><td style='text-align: left;'><code>stalled</code></td><td style='text-align: left;'>The user agent is trying to fetch media data, but data is unexpectedly not forthcoming. networkState is NETWORK_LOADING.</td>
</tr><tr><td style='text-align: left;'><code>play</code></td><td style='text-align: left;'>Playback has begun. Fired after the play() method has returned, or when the autoplay attribute has caused playback to begin. paused is newly false.</td>
</tr><tr><td style='text-align: left;'><code>pause</code></td><td style='text-align: left;'>Playback has been paused. Fired after the pause() method has returned. paused is newly true.</td>
</tr><tr><td style='text-align: left;'><code>loadedmetadata</code></td><td style='text-align: left;'>The user agent has just determined the duration and dimensions of the media resource and the timed tracks are ready. readyState is newly equal to HAVE_METADATA or greater for the first time.</td>
</tr><tr><td style='text-align: left;'><code>loadeddata</code></td><td style='text-align: left;'>The user agent can render the media data at the current playback position for the first time. readyState newly increased to HAVE_CURRENT_DATA or greater for the first time.</td>
</tr><tr><td style='text-align: left;'><code>waiting</code></td><td style='text-align: left;'>Playback has stopped because the next frame is not available, but the user agent expects that frame to become available in due course. readyState is newly equal to or less than HAVE_CURRENT_DATA, and paused is false. Either seeking is true, or the current playback position is not contained in any of the ranges in buffered. It is possible for playback to stop for two other reasons without paused being false, but those two reasons do not fire this event: maybe playback ended, or playback stopped due to errors.</td>
</tr><tr><td style='text-align: left;'><code>playing</code></td><td style='text-align: left;'>Playback has started. readyState is newly equal to or greater than HAVE_FUTURE_DATA, paused is false, seeking is false, or the current playback position is contained in one of the ranges in buffered.</td>
</tr><tr><td style='text-align: left;'><code>canplay</code></td><td style='text-align: left;'>The user agent can resume playback of the media data, but estimates that if playback were to be started now, the media resource could not be rendered at the current playback rate up to its end without having to stop for further buffering of content. readyState newly increased to HAVE_FUTURE_DATA or greater.</td>
</tr><tr><td style='text-align: left;'><code>canplaythrough</code></td><td style='text-align: left;'>The user agent estimates that if playback were to be started now, the media resource could be rendered at the current playback rate all the way to its end without having to stop for further buffering. readyState is newly equal to HAVE_ENOUGH_DATA.</td>
</tr><tr><td style='text-align: left;'><code>seeking</code></td><td style='text-align: left;'>The seeking IDL attribute changed to true and the seek operation is taking long enough that the user agent has time to fire the event.</td>
</tr><tr><td style='text-align: left;'><code>seeked</code></td><td style='text-align: left;'>The seeking IDL attribute changed to false.</td>
</tr><tr><td style='text-align: left;'><code>timeupdate</code></td><td style='text-align: left;'>The current playback position changed as part of normal playback or in an especially interesting way, for example discontinuously.</td>
</tr><tr><td style='text-align: left;'><code>ended</code></td><td style='text-align: left;'>Playback has stopped because the end of the media resource was reached. currentTime equals the end of the media resource; ended is true.</td>
</tr><tr><td style='text-align: left;'><code>ratechange</code></td><td style='text-align: left;'>Either the defaultPlaybackRate or the playbackRate attribute has just been updated.</td>
</tr><tr><td style='text-align: left;'><code>durationchange</code></td><td style='text-align: left;'>The duration attribute has just been updated.</td>
</tr><tr><td style='text-align: left;'><code>volumechange</code></td><td style='text-align: left;'>Either the volume attribute or the muted attribute has changed. Fired after the relevant attribute&#8217;s setter has returned.</td>
</tr></tbody></table>

        </div>
      
      </div>
      
    </div> <!-- /container -->

      <div class="footer">
    <div class="container">
      <p>TAL is an Open Source BBC project from TV Platforms in Salford</p>
      <p>All code and documentation is licensed under Apache License v2.0</p>
      <p>Documentation built using <a href="http://jekyllrb.com/">Jekyll</a>, <a href="http://twitter.github.com/bootstrap/">Bootstrap</a>, and <a href="http://pygments.org/">Pygments</a>. Hosted on GitHub pages.</p>
    </div>
  </div>
    
        <!-- Javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/tal/js/jquery.min.js"></script>
    <script src="/tal/js/bootstrap.min.js"></script>

  </body>

</html>

